# 노인맞춤돌봄서비스 상시모니터링 시스템 개발 - 기술적 세부사항

## 기술적 세부 사항
1. **서버 구성**:
   - Node.js와 Express 프레임워크 활용
   - RESTful API 설계
   - 구글 시트 API 연동을 위한 googleapis 라이브러리 사용

2. **프론트엔드**:
   - HTML5, CSS3, JavaScript(ES6+)
   - 반응형 디자인을 위한 Tailwind CSS 활용
   - 사용자 경험 개선을 위한 AJAX 요청 처리

3. **데이터 관리**:
   - 모든 데이터는 구글 시트에 저장
   - 캐싱 메커니즘 구현으로 성능 최적화
   - 데이터 백업 및 복구 메커니즘 마련

4. **보안**:
   - 기본적인 인증 시스템 구현
   - 데이터 접근 제어 기능
   - 입력 데이터 유효성 검증

## 구글 시트 설계 및 연동 사항

### 구글 시트 구조 설계
1. **마스터 시트**:
   - `위원_기관_매핑`: 모니터링위원과 담당 기관 간의 연결 관계 관리
   - `지표_관리`: 모든 모니터링 지표와 속성 정보 관리
   - `기관_목록`: 55개 수행기관의 기본 정보 관리
   - `시스템_설정`: 시스템 전반의 설정값 관리 (평가 주기, 상태 코드 등)

2. **위원별 전용 시트**:
   - 각 모니터링위원별로 전용 시트 생성 (총 5개)
   - 시트명 형식: `위원명_모니터링`
   - 담당 기관별 탭 구성으로 위원이 자신의 담당 기관만 효율적으로 관리
   - 각 탭에는 해당 기관의 평가 결과를 주기별(매월/반기/연중/1~3월)로 구분하여 표시

3. **통합 결과 시트**:
   - `모니터링_결과_통합`: 모든 평가 결과를 취합하는 통합 시트
   - 자동 통계 및 분석 기능 내장 (충족률, 미충족 항목 요약 등)
   - 피벗 테이블 활용한 다차원 분석 뷰 제공

### 구글 시트 디자인 및 사용성 개선
1. **구조화된 데이터 포맷**:
   - 헤더 고정 및 셀 서식 일관성 유지
   - 데이터 유효성 검사 적용 (드롭다운 목록으로 선택 옵션 제한)
   - 조건부 서식으로 상태별 시각적 구분 (충족: 녹색, 미충족: 붉은색, 해당없음: 회색)

2. **사용자 경험 향상**:
   - 위원 전용 시트는 필터링 및 정렬 기능 활성화
   - 데이터 입력 영역과 참조용 영역 명확히 구분 (배경색 차별화)
   - 시각적 가이드 및 설명 텍스트 포함
   - 마스터 시트 보호 기능 적용 (실수로 인한 데이터 손실 방지)

3. **자동화 및 효율성**:
   - QUERY, VLOOKUP 함수 활용한 데이터 자동 연동
   - 위원별 진행 상황을 자동 집계하는 대시보드 시트
   - 날짜 기반 조건부 서식으로 미처리 항목 자동 강조
   - 매크로 버튼으로 일괄 작업 간소화 (시트 초기화, 데이터 업데이트 등)

4. **모바일 접근성**:
   - 모바일에서도 주요 기능 사용 가능하도록 최적화
   - 중요 열 고정으로 좌우 스크롤 시에도 핵심 정보 유지
   - 글꼴 크기 조정으로 가독성 확보

### 구글 시트 API 연동
1. **데이터 연동 방식**:
   - Node.js 서버와 구글 시트 간 양방향 실시간 데이터 연동
   - Google Sheets API v4 활용
   - OAuth 2.0 인증 방식 적용

2. **데이터 처리 흐름**:
   - 읽기 작업: 위원 로그인 시 담당 기관 및 기존 평가 데이터 로드
   - 쓰기 작업: 평가 결과 저장 시 해당 위원의 시트에 데이터 기록 및 통합 시트 자동 업데이트
   - 정기적 백업 자동화 (일일 백업 시트 자동 생성)

3. **에러 처리 및 충돌 방지**:
   - 동시 편집 충돌 최소화를 위한 락(lock) 메커니즘 구현
   - API 요청 실패 시 로컬 캐싱 및 재시도 로직 구현
   - 데이터 변경 이력 추적 기능 (변경 일시, 수정자 정보 자동 기록)